Pipeline:
这是一个单细胞多模态组学的topic model，其结果具体如下：
一共有两条路径（所以我希望将这两个路径分别放在一个子文件夹并通过库的形式调用，这样实现可拓展性），他们分别是cellgraph、featuregraph。
-针对cellgraph：
1、我输入来自于同一个dataset多个模态的矩阵（e.g. gene、ATAC、protein），针对三个输入的模态矩阵各有一个自己的encoder将他们三个组学投影到同一个维度上，他们的参数是各自更新的。
2、随后通过一个Multimodel Fusion Block（这个本质上也是一个encoder，内部机制我在后面拓展）将三个模态的embedding进行融合，得到一个融合后的embedding（cell x emb）。
3、基于上述这个cell x emb进行生物信息学领域Trajectory Inference，我希望拿到的是一个cell2cell的有向矩阵，用以反映这个cell的state关系,随后利用kernel的方式将这个矩阵转化成邻接矩阵
4、随后保持这个邻接矩阵的Graph（cell作为node）结构固定，并用step2的cell x emb对矩阵上的每个cell进行value初始化
5、对这个value初始化后的graph使用directed GNN方法，重新得到矩阵cell x F，再对这个cell x F使用一个encoder得到Q(θ_d)（其实是一个向量表示θ_d）
6、对Q（θ_d）进行softmax并sampling，可以得到这个θ_d（形状为cell x topic的矩阵）

--Multimodel Fusion Block:
暂时你帮我实现一种基于多头注意力的encoder，用于接受来自不同模态的投影矩阵并输出一个cell x emb

-针对featuregraph：
1、我有很多的先验信息，你也需要为我做一个新的文件夹专门存放，并且是featuregraph的子文件夹（Ⅰ尽可能多的database，相较于上面的dataset更为丰富；Ⅱ由诸多foundation model生成的embedding(e.g. GenePT)；Ⅲliterature，例如gene2peak、peak2protein等等的meta path）
2、将我的先验信息以及cellgraph的dataset的feature一并构建成一个feature作为node的异构有向图（不同的node表示不同的特征，例如gene、peak、protein...不同的edge表示不同的meta path）
3、对上面这个异构有向图使用Heterogeneous directed GNN的方法，分别得到各个模态的embedding（Feature x emb_k）
4、分别对各个模态使用单独的encoder处理得到Q（B_d），并同样softmax并sampling得到各自的B_d（本质是形状为Feature x topic的矩阵）

-针对整合处
1、将上述两个stream得到的θ_d以及各个模态各自的B_d，一并用于还原出原始数据形状。利用θ_d进行重参数化，得到各个模态共用的cell x topic
2、然后需要矩阵topic x embedding，以及embedding x feature（二者相乘是Feature x topic，这个地方需要输入B_d来控制两个矩阵的学习，类似分解一类），之后的decoder中就是将cell x topic与topic x embedding相乘得到cell x embedding，再与embedding x feature相乘得到cell x feature实现还原
3、整个过程的训练遵循VAE，也就是意味着需要控制likelihood以及KL散度








